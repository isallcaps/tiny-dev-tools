import{a as $e}from"./chunk-HSK5ZXTS.js";import{a as Pe,b as He,c as Qe,i as Ge}from"./chunk-AQBEIGKJ.js";import{c as U,e as Ue,g as de}from"./chunk-ZHKWAVRD.js";import{$ as v,$a as a,Cb as F,D as _e,Ea as Ee,Fb as Oe,Gb as x,Hb as Re,I as ye,Ib as se,J as Ce,L as xe,La as I,Ma as Fe,Na as k,Oa as Me,Pa as P,R as Ne,S as we,Tb as Ve,Ua as H,Va as _,W as p,Wa as y,Xa as R,Ya as D,Yb as Be,Za as S,_a as m,a as W,aa as h,ab as s,ac as Je,b as Z,bb as f,bc as Le,ca as Ie,cb as Y,cc as Ae,da as O,db as Q,dc as le,e as he,eb as E,f as be,fa as q,fb as j,ga as ke,gb as g,hb as qe,ib as u,ka as w,la as oe,lb as re,mb as je,na as De,nb as G,oa as Se,ob as $,pa as z,pb as ae,qa as A,qb as V,sb as c,tb as T,ub as C,xb as X,ya as d,yb as Te}from"./chunk-EE7DCZE3.js";function We(t){let o=t.split(/\r?\n/).map(b=>b.trim()).filter(Boolean);if(!o.length)return[];let[e,...n]=o,i=e.split(",").map(b=>b.trim().toLowerCase()),r=i.indexOf("jirafield"),l=i.indexOf("jiravalue"),J=i.indexOf("description"),L=i.indexOf("group");return r===-1||l===-1?(console.warn("CSV missing required headers: jiraField,jiraValue"),[]):n.reduce((b,M)=>{let N=M.split(",").map(at=>at.trim()),fe=N[r],ve=N[l];return!fe||!ve||b.push({jiraField:fe,jiraValue:ve,description:J>=0&&N[J]||void 0,group:L>=0&&N[L]||void 0}),b},[])}function ce(t){let o={};for(let e of t){let n=e.jiraField;o[n]||(o[n]={ungrouped:[],groups:{}});let i=e.group?.trim();i?(o[n].groups[i]||(o[n].groups[i]=[]),o[n].groups[i].push(e)):o[n].ungrouped.push(e)}return o}function Ze(t,o){let e=[];for(let n of Object.keys(t)){let i=t[n],r=[];for(let b of i.ungrouped){let M=b.jiraValue.trim();M&&o[n]?.[M]&&r.push(M)}for(let b of Object.keys(i.groups))for(let M of i.groups[b]){let N=M.jiraValue.trim();N&&o[n]?.[N]&&r.push(N)}if(!r.length)continue;let l=Array.from(new Set(r)).sort(),L=/[^\w]/.test(n)?`"${n}"`:n;if(l.length===1){let b=l[0];e.push(`${L} = ${Ke(b)}`)}else e.push(`${L} in (${l.map(Ke).join(", ")})`)}return e.join(" AND ")}function Ke(t){return/[\s-]/.test(t)?`"${t}"`:t}function B(t){t||(t=p(O));let o=new he(e=>{if(t.destroyed){e.next();return}return t.onDestroy(e.next.bind(e))});return e=>e.pipe(xe(o))}var st=["ngbNavOutlet",""],lt=t=>({$implicit:t});function dt(t,o){}function ct(t,o){if(t&1&&(a(0,"div",0),P(1,dt,0,0,"ng-template",1),s()),t&2){let e=u().$implicit,n=u();m("item",e)("nav",n.nav)("role",n.paneRole),d(),m("ngTemplateOutlet",(e.contentTpl==null?null:e.contentTpl.templateRef)||null)("ngTemplateOutletContext",Te(5,lt,e.active||n.isPanelTransitioning(e)))}}function ut(t,o){if(t&1&&_(0,ct,2,7,"div",0),t&2){let e=o.$implicit,n=u();y(e.isPanelInDom()||n.isPanelTransitioning(e)?0:-1)}}var pt=(()=>{class t{constructor(){this._ngbConfig=p($e),this.destroyOnHide=!0,this.orientation="horizontal",this.roles="tablist",this.keyboard=!0}get animation(){return this._animation??this._ngbConfig.animation}set animation(e){this._animation=e}static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275prov=Ne({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})(),Ye=t=>U(t)&&t!=="",mt=0,pe=(()=>{class t{constructor(){this.templateRef=p(Ee)}static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275dir=k({type:t,selectors:[["ng-template","ngbNavContent",""]]})}}return t})(),Xe=(()=>{class t{constructor(e){this.role=e,this.nav=p(K)}static{this.\u0275fac=function(n){return new(n||t)(z("role"))}}static{this.\u0275dir=k({type:t,selectors:[["","ngbNavItem","",5,"ng-container"]],hostVars:1,hostBindings:function(n,i){n&2&&H("role",i.role?i.role:i.nav.roles?"presentation":void 0)}})}}return t})(),ee=(()=>{class t{constructor(){this._nav=p(K),this._nativeElement=p(A).nativeElement,this.disabled=!1,this.shown=new q,this.hidden=new q}ngOnInit(){U(this.domId)||(this.domId=`ngb-nav-${mt++}`)}get active(){return this._nav.activeId===this.id}get id(){return Ye(this._id)?this._id:this.domId}get panelDomId(){return`${this.domId}-panel`}isPanelInDom(){return(U(this.destroyOnHide)?!this.destroyOnHide:!this._nav.destroyOnHide)||this.active}isNgContainer(){return this._nativeElement.nodeType===Node.COMMENT_NODE}static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275dir=k({type:t,selectors:[["","ngbNavItem",""]],contentQueries:function(n,i,r){if(n&1&&re(r,pe,4),n&2){let l;G(l=$())&&(i.contentTpl=l.first)}},hostAttrs:[1,"nav-item"],inputs:{destroyOnHide:"destroyOnHide",disabled:"disabled",domId:"domId",_id:[0,"ngbNavItem","_id"]},outputs:{shown:"shown",hidden:"hidden"},exportAs:["ngbNavItem"]})}}return t})(),K=(()=>{class t{constructor(e){this.role=e,this._config=p(pt),this._cd=p(se),this._document=p(Ie),this._nativeElement=p(A).nativeElement,this.destroyRef=p(O),this._navigatingWithKeyboard=!1,this.activeIdChange=new q,this.animation=this._config.animation,this.destroyOnHide=this._config.destroyOnHide,this.orientation=this._config.orientation,this.roles=this._config.roles,this.keyboard=this._config.keyboard,this.shown=new q,this.hidden=new q,this.navItemChange$=new be,this.navChange=new q}click(e){e.disabled||this._updateActiveId(e.id)}onFocusout({relatedTarget:e}){this._nativeElement.contains(e)||(this._navigatingWithKeyboard=!1)}onKeyDown(e){if(this.roles!=="tablist"||!this.keyboard)return;let n=this.links.filter(l=>!l.navItem.disabled),{length:i}=n,r=-1;if(n.forEach((l,J)=>{l.nativeElement===this._document.activeElement&&(r=J)}),i){switch(e.key){case"ArrowUp":case"ArrowLeft":r=(r-1+i)%i;break;case"ArrowRight":case"ArrowDown":r=(r+1)%i;break;case"Home":r=0;break;case"End":r=i-1;break}this.keyboard==="changeWithArrows"&&this.select(n[r].navItem.id),n[r].nativeElement.focus(),this._navigatingWithKeyboard=!0,e.preventDefault()}}select(e){this._updateActiveId(e,!1)}ngAfterContentInit(){if(!U(this.activeId)){let e=this.items.first?this.items.first.id:null;Ye(e)&&(this._updateActiveId(e,!1),this._cd.detectChanges())}this.items.changes.pipe(B(this.destroyRef)).subscribe(()=>this._notifyItemChanged(this.activeId))}ngOnChanges({activeId:e}){e&&!e.firstChange&&this._notifyItemChanged(e.currentValue)}_updateActiveId(e,n=!0){if(this.activeId!==e){let i=!1;n&&this.navChange.emit({activeId:this.activeId,nextId:e,preventDefault:()=>{i=!0}}),i||(this.activeId=e,this.activeIdChange.emit(e),this._notifyItemChanged(e))}}_notifyItemChanged(e){this.navItemChange$.next(this._getItemById(e))}_getItemById(e){return this.items&&this.items.find(n=>n.id===e)||null}static{this.\u0275fac=function(n){return new(n||t)(z("role"))}}static{this.\u0275dir=k({type:t,selectors:[["","ngbNav",""]],contentQueries:function(n,i,r){if(n&1&&re(r,ee,4)(r,te,5),n&2){let l;G(l=$())&&(i.items=l),G(l=$())&&(i.links=l)}},hostAttrs:[1,"nav"],hostVars:4,hostBindings:function(n,i){n&1&&g("keydown.arrowLeft",function(l){return i.onKeyDown(l)})("keydown.arrowRight",function(l){return i.onKeyDown(l)})("keydown.arrowDown",function(l){return i.onKeyDown(l)})("keydown.arrowUp",function(l){return i.onKeyDown(l)})("keydown.Home",function(l){return i.onKeyDown(l)})("keydown.End",function(l){return i.onKeyDown(l)})("focusout",function(l){return i.onFocusout(l)}),n&2&&(H("aria-orientation",i.orientation==="vertical"&&i.roles==="tablist"?"vertical":void 0)("role",i.role?i.role:i.roles?"tablist":void 0),V("flex-column",i.orientation==="vertical"))},inputs:{activeId:"activeId",animation:"animation",destroyOnHide:"destroyOnHide",orientation:"orientation",roles:"roles",keyboard:"keyboard"},outputs:{activeIdChange:"activeIdChange",shown:"shown",hidden:"hidden",navChange:"navChange"},exportAs:["ngbNav"],features:[De]})}}return t})(),te=(()=>{class t{constructor(e){this.role=e,this.navItem=p(ee),this.nav=p(K),this.nativeElement=p(A).nativeElement}get tabindex(){return this.nav.keyboard===!1?this.navItem.disabled?-1:void 0:this.nav._navigatingWithKeyboard||this.navItem.disabled||!this.navItem.active?-1:void 0}static{this.\u0275fac=function(n){return new(n||t)(z("role"))}}static{this.\u0275dir=k({type:t,selectors:[["","ngbNavLink",""]],hostAttrs:[1,"nav-link"],hostVars:12,hostBindings:function(n,i){n&2&&(j("id",i.navItem.domId),H("role",i.role?i.role:i.nav.roles?"tab":void 0)("tabindex",i.tabindex)("aria-controls",i.navItem.isPanelInDom()?i.navItem.panelDomId:null)("aria-selected",i.navItem.active)("aria-disabled",i.navItem.disabled),V("nav-item",i.navItem.isNgContainer())("active",i.navItem.active)("disabled",i.navItem.disabled))}})}}return t})(),et=(()=>{class t extends te{static{this.\u0275fac=(()=>{let e;return function(i){return(e||(e=Se(t)))(i||t)}})()}static{this.\u0275dir=k({type:t,selectors:[["button","ngbNavLink",""]],hostAttrs:["type","button"],hostVars:1,hostBindings:function(n,i){n&1&&g("click",function(){return i.nav.click(i.navItem)}),n&2&&j("disabled",i.navItem.disabled)},features:[Me]})}}return t})();var gt=({classList:t})=>(t.remove("show"),()=>t.remove("active")),ft=(t,o)=>{o&&Ue(t),t.classList.add("show")},ze=(()=>{class t{constructor(){this.nativeElement=p(A).nativeElement}static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275dir=k({type:t,selectors:[["","ngbNavPane",""]],hostAttrs:[1,"tab-pane"],hostVars:5,hostBindings:function(n,i){n&2&&(j("id",i.item.panelDomId),H("role",i.role?i.role:i.nav.roles?"tabpanel":void 0)("aria-labelledby",i.item.domId),V("fade",i.nav.animation))},inputs:{item:"item",nav:"nav",role:"role"}})}}return t})(),tt=(()=>{class t{constructor(){this._cd=p(se),this._ngZone=p(ke),this._activePane=null}isPanelTransitioning(e){return this._activePane?.item===e}ngAfterViewInit(){this._updateActivePane(),this.nav.navItemChange$.pipe(B(this.nav.destroyRef),Ce(this._activePane?.item||null),_e(),ye(1)).subscribe(e=>{let n={animation:this.nav.animation,runningTransition:"stop"};this._cd.detectChanges(),this._activePane?de(this._ngZone,this._activePane.nativeElement,gt,n).subscribe(()=>{let i=this._activePane?.item;this._activePane=this._getPaneForItem(e),this._cd.markForCheck(),this._activePane&&(this._activePane.nativeElement.classList.add("active"),de(this._ngZone,this._activePane.nativeElement,ft,n).subscribe(()=>{e&&(e.shown.emit(),this.nav.shown.emit(e.id))})),i&&(i.hidden.emit(),this.nav.hidden.emit(i.id))}):this._updateActivePane()})}_updateActivePane(){this._activePane=this._getActivePane(),this._activePane?.nativeElement.classList.add("show","active")}_getPaneForItem(e){return this._panes&&this._panes.find(n=>n.item===e)||null}_getActivePane(){return this._panes&&this._panes.find(e=>e.item.active)||null}static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275cmp=I({type:t,selectors:[["","ngbNavOutlet",""]],viewQuery:function(n,i){if(n&1&&je(ze,5),n&2){let r;G(r=$())&&(i._panes=r)}},hostAttrs:[1,"tab-content"],inputs:{paneRole:"paneRole",nav:[0,"ngbNavOutlet","nav"]},attrs:st,decls:2,vars:0,consts:[["ngbNavPane","",3,"item","nav","role"],[3,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(n,i){n&1&&D(0,ut,1,1,null,null,R),n&2&&S(i.nav.items)},dependencies:[ze,Ve],encapsulation:2,changeDetection:0})}}return t})();var nt=(()=>{class t{static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275mod=Fe({type:t})}static{this.\u0275inj=we({})}}return t})();function vt(t,o){if(t&1&&(Y(0,"span",4),c(1),Q()),t&2){let e=u();d(),C(" - ",e.description())}}var ne=class t{field=x.required();value=x.required();groupName=x();description=x();checked=Re(!1);inputId=F(()=>{let o=this.groupName();return o?`cb_${this.field()}_${o}_${this.value()}`:`cb_${this.field()}_${this.value()}`});onChange(o){let e=o.target.checked;this.checked.set(e)}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=I({type:t,selectors:[["app-jql-value-checkbox"]],inputs:{field:[1,"field"],value:[1,"value"],groupName:[1,"groupName"],description:[1,"description"],checked:[1,"checked"]},outputs:{checked:"checkedChange"},decls:6,vars:5,consts:[[1,"form-check"],["type","checkbox",1,"form-check-input",3,"change","id","checked"],[1,"form-check-label",3,"for"],[1,"fw-bold","font-monospace"],[1,"fw-light","text-secondary"]],template:function(e,n){e&1&&(Y(0,"div",0)(1,"input",1),qe("change",function(r){return n.onChange(r)}),Q(),Y(2,"label",2)(3,"span",3),c(4),Q(),_(5,vt,2,1,"span",4),Q()()),e&2&&(d(),j("id",n.inputId())("checked",n.checked()),d(),j("htmlFor",n.inputId()),d(2),T(n.value()),d(),y(n.description()?5:-1))},encapsulation:2})};var ht=()=>[],ot=(t,o)=>o.jiraValue;function bt(t,o){if(t&1&&(a(0,"div",2),f(1,"i",5),a(2,"span",6),c(3),s(),a(4,"span",7),c(5),s()()),t&2){let e=u(2);d(3),T(e.ungroupedLabel),d(2),C(" ",e.fieldConfig().ungrouped.length," ")}}function _t(t,o){if(t&1){let e=E();a(0,"app-jql-value-checkbox",8),g("checkedChange",function(i){let r=v(e).$implicit,l=u(2);return h(l.onCheckboxChange(r.jiraValue,i))}),s()}if(t&2){let e=o.$implicit,n=u(2);m("field",n.field())("value",e.jiraValue)("description",e.description)("checked",n.isSelected(e.jiraValue))}}function yt(t,o){if(t&1&&(a(0,"div",1),_(1,bt,6,2,"div",2),a(2,"div",3),D(3,_t,1,4,"app-jql-value-checkbox",4,ot),s()()),t&2){let e=u();d(),y(e.hasGroups()?1:-1),d(2),S(e.fieldConfig().ungrouped)}}function Ct(t,o){if(t&1){let e=E();a(0,"app-jql-value-checkbox",13),g("checkedChange",function(i){let r=v(e).$implicit,l=u(2);return h(l.onCheckboxChange(r.jiraValue,i))}),s()}if(t&2){let e=o.$implicit,n=u().$implicit,i=u();m("field",i.field())("groupName",n)("value",e.jiraValue)("description",e.description)("checked",i.isSelected(e.jiraValue))}}function xt(t,o){if(t&1&&(a(0,"div",1)(1,"div",9),f(2,"i",10),a(3,"span",6),c(4),s(),a(5,"span",11),c(6),s()(),a(7,"div",3),D(8,Ct,1,5,"app-jql-value-checkbox",12,ot),s()()),t&2){let e,n,i=o.$implicit,r=u();d(4),T(i),d(2),C(" ",((e=r.fieldConfig().groups)==null||e[i]==null?null:e[i].length)??0," "),d(2),S(((n=r.fieldConfig().groups)==null?null:n[i])??X(2,ht))}}var ie=class t{field=x.required();fieldConfig=x.required();selectionsForField=x({});selectionChange=Oe();ungroupedLabel="Everything Else";groupNames=F(()=>Object.keys(this.fieldConfig()?.groups??{}));hasGroups=F(()=>this.groupNames().length>0);isSelected(o){return!!this.selectionsForField()[o]}onCheckboxChange(o,e){this.selectionChange.emit({field:this.field(),value:o,checked:e})}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=I({type:t,selectors:[["app-jql-group-columns"]],inputs:{field:[1,"field"],fieldConfig:[1,"fieldConfig"],selectionsForField:[1,"selectionsForField"]},outputs:{selectionChange:"selectionChange"},decls:4,vars:1,consts:[[1,"row","g-4"],[1,"col-12","col-md-6","col-lg-4"],[1,"mb-2","d-flex","align-items-center","gap-2","text-body-secondary","small","fw-bold"],[1,"checkbox-group-container"],[3,"field","value","description","checked"],[1,"bi","bi-collection-fill","opacity-50"],[1,"text-uppercase","tracking-wider"],[1,"badge","rounded-pill","bg-body-secondary","text-body-secondary","border","px-2"],[3,"checkedChange","field","value","description","checked"],[1,"mb-2","d-flex","align-items-center","gap-2","small","fw-bold","text-body"],[1,"bi","bi-folder-fill","text-primary","opacity-75"],[1,"badge","rounded-pill","bg-primary-subtle","text-primary-emphasis","border","border-primary-subtle","px-2"],[3,"field","groupName","value","description","checked"],[3,"checkedChange","field","groupName","value","description","checked"]],template:function(e,n){if(e&1&&(a(0,"div",0),_(1,yt,5,1,"div",1),D(2,xt,10,3,"div",1,R),s()),e&2){let i;d(),y((i=n.fieldConfig().ungrouped)!=null&&i.length?1:-1),d(),S(n.groupNames())}},dependencies:[ne],encapsulation:2})};var Nt=()=>({});function wt(t,o){if(t&1&&(a(0,"span",23),f(1,"i",33),c(2),s()),t&2){let e=u(2);d(2),C(" ",e.csvFileName()," ")}}function It(t,o){t&1&&(a(0,"span",24),c(1,"No file selected"),s())}function kt(t,o){t&1&&(a(0,"div",27),f(1,"i",34),a(2,"p",35),c(3,"Drop CSV to Load"),s()())}function Dt(t,o){if(t&1&&(a(0,"div",32),f(1,"i",36),c(2," Active configuration detected for "),a(3,"strong"),c(4),s(),c(5," Jira fields. "),s()),t&2){let e=u(2);d(4),T(e.fieldKeys().length)}}function St(t,o){if(t&1){let e=E();a(0,"div",10)(1,"div",11)(2,"div")(3,"h2",12),c(4,"CSV Configuration"),s(),a(5,"p",13),c(6," Paste or Drag & Drop a CSV with "),a(7,"code"),c(8,"jiraField, jiraValue, description, group"),s()()(),a(9,"button",14),g("click",function(){v(e);let i=u();return h(i.clearLocalConfig())}),f(10,"i",15),c(11," Clear "),s()(),a(12,"div",16)(13,"div",17)(14,"label",18),f(15,"i",19),c(16," Upload CSV "),a(17,"input",20),g("change",function(i){v(e);let r=u();return h(r.onFileSelected(i))}),s()(),f(18,"div",21),a(19,"div",22),_(20,wt,3,1,"span",23)(21,It,2,0,"span",24),s()()(),a(22,"div",25)(23,"textarea",26,1),g("fileDropped",function(i){v(e);let r=u();return h(r.onFileDropped(i))})("ngModelChange",function(i){v(e);let r=u();return h(r.csvInput.set(i))}),c(25,"                    "),s(),_(26,kt,4,0,"div",27),s(),a(27,"div",28)(28,"button",29),g("click",function(){v(e);let i=u();return h(i.loadSampleCsv())}),f(29,"i",30),c(30," Load sample CSV "),s(),a(31,"button",31),g("click",function(){v(e);let i=u();return h(i.onApplyCsv())}),c(32," Apply Configuration "),s()(),_(33,Dt,6,1,"div",32),s()}if(t&2){let e=ae(24),n=u();d(9),m("disabled",!n.csvInput()&&!n.fieldKeys().length),d(11),y(n.csvFileName()?20:21),d(3),V("file-over",e.fileOver),m("ngModel",n.csvInput()),d(3),y(e.fileOver?26:-1),d(5),m("disabled",!n.csvInput()||!n.csvInput().trim()),d(2),y(n.fieldKeys().length?33:-1)}}function Et(t,o){if(t&1){let e=E();a(0,"div",43)(1,"div",46)(2,"h3",47),c(3),s()(),a(4,"div",48)(5,"app-jql-group-columns",49),g("selectionChange",function(i){v(e);let r=u(3);return h(r.onFieldSelectionChange(i))}),s()()()}if(t&2){let e=o.$implicit,n=u(3);d(3),C(" ",e," "),d(2),m("field",e)("fieldConfig",n.grouped()[e])("selectionsForField",n.selections()[e]||X(4,Nt))}}function Ft(t,o){if(t&1){let e=E();a(0,"textarea",50),g("ngModelChange",function(i){v(e);let r=u(3);return h(r.manualQuery.set(i))}),c(1,"                         "),s(),a(2,"div",28)(3,"button",51),g("click",function(){v(e);let i=u(3);return h(i.resetQuery())}),f(4,"i",52),c(5," Reset to Generated "),s(),f(6,"app-copy-to-clipboard-btn",53),s()}if(t&2){let e=u(3);m("ngModel",e.manualQuery()),d(6),m("textToCopy",e.manualQuery()||e.generatedJql())}}function Mt(t,o){t&1&&(a(0,"div",45)(1,"p",54),c(2,"Select at least one value above to generate JQL."),s()())}function qt(t,o){if(t&1&&(a(0,"div",42),D(1,Et,6,5,"div",43,R),s(),a(3,"h3",44),c(4,"Generated JQL"),s(),_(5,Ft,7,2)(6,Mt,3,0,"div",45)),t&2){let e=u(2);d(),S(e.fieldKeys()),d(4),y(e.generatedJql()?5:6)}}function jt(t,o){t&1&&(a(0,"div",41),f(1,"i",55),a(2,"p",56),c(3,"No configuration loaded. Start in the "),a(4,"strong"),c(5,"Config"),s(),c(6," tab."),s()())}function Tt(t,o){if(t&1&&(a(0,"div",37)(1,"div",38)(2,"h2",39),c(3,"Values & Selection"),s(),a(4,"span",40),c(5),s()(),_(6,qt,7,1)(7,jt,7,0,"div",41),s()),t&2){let e=u();d(5),C(" ",e.fieldKeys().length," Fields "),d(),y(e.fieldKeys().length?6:7)}}var me="tiny-dev-tools:jql-config-rows",ge="tiny-dev-tools:jql-selections",rt=class t{tool=Be;csvInput=w("");csvFileName=w("");grouped=w({});selections=w({});manualQuery=w("");activeTab=w("config");fieldKeys=F(()=>Object.keys(this.grouped()));generatedJql=F(()=>Ze(this.grouped(),this.selections()));destroyRef=p(O);constructor(){oe(()=>{let o=this.selections();Object.keys(o).length&&localStorage.setItem(ge,JSON.stringify(o))})}ngOnInit(){this.loadFromLocalStorage()}onFileDropped(o){this.csvFileName.set(o.name),le(o).pipe(B(this.destroyRef)).subscribe({next:e=>{this.csvInput.set(e)},error:e=>{console.error(e),this.csvFileName.set("Error loading file")}})}onFileSelected(o){let n=o.target.files?.[0];n&&(this.csvFileName.set(n.name),le(n).pipe(B(this.destroyRef)).subscribe({next:i=>{this.csvInput.set(i)},error:i=>{console.error(i),this.csvFileName.set("Error loading file")}}))}updateManualQuery(){this.manualQuery.set(this.generatedJql())}onApplyCsv(){let o=We(this.csvInput());if(!o.length){this.clearLocalConfig();return}let e=ce(o);this.grouped.set(e);let n=this.createInitialSelections(e);this.selections.set(n),localStorage.setItem(me,JSON.stringify(o)),this.updateManualQuery(),this.activeTab.set("query")}onFieldSelectionChange(o){this.selections.update(e=>{let n=Z(W({},e[o.field]),{[o.value]:o.checked});return Z(W({},e),{[o.field]:n})}),this.updateManualQuery()}loadFromLocalStorage(){try{let o=localStorage.getItem(me);if(!o)return;let e=JSON.parse(o),n=ce(e);this.grouped.set(n);let i=localStorage.getItem(ge);i?this.selections.set(JSON.parse(i)):this.selections.set(this.createInitialSelections(n)),this.updateManualQuery(),this.fieldKeys().length&&this.activeTab.set("query")}catch(o){console.warn("Failed to load JQL config",o)}}createInitialSelections(o){let e={};for(let n of Object.keys(o)){e[n]={};let i=o[n];[...i.ungrouped||[],...Object.values(i.groups||[]).flat()].forEach(r=>e[n][r.jiraValue]=!1)}return e}clearLocalConfig(){this.grouped.set({}),this.selections.set({}),this.csvInput.set(""),this.csvFileName.set(""),this.manualQuery.set(""),localStorage.removeItem(me),localStorage.removeItem(ge),this.activeTab.set("config")}resetQuery(){this.updateManualQuery()}loadSampleCsv(){this.csvInput().trim()&&!confirm("Replace the current CSV with a sample?")||(this.csvFileName.set("sample-jira-config.csv"),this.csvInput.set(`jiraField,jiraValue,description,group
project,DEV,Main dev project,
component,Core,Shared core logic,
component,UI,User-facing stuff,
"Epic Link",DEV-42,The big thing we\u2019re working on,
labels,cleanup,Tech debt nobody loves,
labels,frontend,All things UI,
labels,home,Home screen,UI Screens
labels,settings,Settings screen,UI Screens
`))}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=I({type:t,selectors:[["app-jql-but-reusable"]],decls:13,vars:5,consts:[["nav","ngbNav"],["dnd","appDragAndDrop"],[3,"tool"],[1,"card","border-0","bg-transparent"],["ngbNav","",1,"nav","nav-tabs","px-3",3,"activeIdChange","activeId"],[1,"nav-item",3,"ngbNavItem"],["type","button","ngbNavLink","",1,"nav-link","fw-bold"],["ngbNavContent",""],[3,"ngbNavItem"],[3,"ngbNavOutlet"],[1,"card-body","pt-4"],[1,"d-flex","justify-content-between","align-items-center","mb-4"],[1,"h5","mb-1","fw-bold"],[1,"text-body-secondary","small","mb-0"],["type","button",1,"btn","btn-sm","btn-outline-danger","rounded-pill","px-3",3,"click","disabled"],[1,"bi","bi-trash3","me-1"],[1,"card","bg-body-tertiary","border-0","mb-3","rounded-4"],[1,"card-body","p-3","d-flex","align-items-center","gap-3"],[1,"btn","btn-primary","btn-sm","rounded-pill","px-3","mb-0"],[1,"bi","bi-file-earmark-arrow-up","me-1"],["type","file","accept",".csv,text/csv",1,"d-none",3,"change"],[1,"vr","text-secondary","opacity-25"],[1,"flex-grow-1","small"],[1,"text-primary","fw-bold"],[1,"text-body-tertiary"],[1,"mb-4","position-relative"],["appDragAndDrop","","id","ta_csv","placeholder","Paste CSV rows here...","rows","10",1,"form-control","tool-textarea","drop-zone","rounded-4",3,"fileDropped","ngModelChange","ngModel"],[1,"dnd-overlay","d-flex","flex-column","align-items-center","justify-content-center","rounded-4"],[1,"d-flex","justify-content-between","align-items-center"],["type","button",1,"btn","btn-link","btn-sm","text-primary","text-decoration-none","p-0","fw-medium",3,"click"],[1,"bi","bi-lightbulb"],["type","button",1,"btn","btn-primary","rounded-pill","px-4",3,"click","disabled"],[1,"alert","bg-primary-subtle","text-primary-emphasis","py-3","px-3","mt-4","mb-0","small","border-0","rounded-4"],[1,"bi","bi-file-check-fill","me-1"],[1,"bi","bi-file-earmark-arrow-up","display-4","text-primary"],[1,"fw-bold","text-primary","mt-2"],[1,"bi","bi-info-circle-fill","me-2"],[1,"card-body","d-flex","flex-column","pt-4"],[1,"d-flex","justify-content-between","align-items-end","mb-3"],[1,"h5","fw-bold","mb-0"],[1,"badge","rounded-pill","bg-primary-subtle","text-primary-emphasis","border","border-primary-subtle"],[1,"text-center","py-5"],[1,"mb-4","container-fluid","border-0","rounded-4","bg-body-tertiary","p-3",2,"max-height","500px","overflow-y","auto"],[1,"row","py-3","border-bottom","last-child-border-0"],[1,"h6","fw-bold","mb-3"],[1,"text-center","py-5","bg-body-tertiary","rounded-4"],[1,"col-12","col-md-3","col-lg-2"],[1,"fw-bold","fs-6","text-uppercase","text-body-secondary","mb-2","mb-md-0"],[1,"col"],[3,"selectionChange","field","fieldConfig","selectionsForField"],["rows","5","placeholder","JQL will appear here...",1,"form-control","tool-textarea","mb-3","rounded-4",3,"ngModelChange","ngModel"],[1,"btn","btn-link","btn-sm","text-body-secondary","text-decoration-none",3,"click"],[1,"bi","bi-arrow-counterclockwise"],[3,"textToCopy"],[1,"text-body-secondary","mb-0"],[1,"bi","bi-clipboard-x","display-1","text-body-tertiary"],[1,"text-body-secondary","mt-3"]],template:function(e,n){if(e&1){let i=E();a(0,"app-tool-layout",2)(1,"div",3)(2,"ul",4,0),g("activeIdChange",function(l){return v(i),h(n.activeTab.set(l))}),a(4,"li",5)(5,"button",6),c(6,"Config"),s(),P(7,St,34,8,"ng-template",7),s(),a(8,"li",8)(9,"button",6),c(10,"Query"),s(),P(11,Tt,8,2,"ng-template",7),s()(),f(12,"div",9),s()()}if(e&2){let i=ae(3);m("tool",n.tool),d(2),m("activeId",n.activeTab()),d(2),m("ngbNavItem","config"),d(4),m("ngbNavItem","query"),d(4),m("ngbNavOutlet",i)}},dependencies:[Le,Je,Ge,Pe,He,Qe,nt,pe,K,ee,Xe,et,te,tt,ie,Ae],encapsulation:2})};export{rt as JqlButReusable};
